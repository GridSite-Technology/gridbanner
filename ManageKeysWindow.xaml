<Window x:Class="GridBanner.ManageKeysWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Manage SSH Keys"
        Width="800"
        Height="550"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        
        <!-- Header -->
        <StackPanel Grid.Row="0" Margin="0,0,0,15">
            <TextBlock Text="SSH Key Management" FontSize="20" FontWeight="Bold" Foreground="#333"/>
            <TextBlock Text="Publish your SSH public keys to the central keyring" FontSize="12" Foreground="#666" Margin="0,5,0,0"/>
        </StackPanel>
        
        <!-- Key Lists -->
        <TabControl Grid.Row="1">
            <!-- Local Keys Tab -->
            <TabItem Header="Local Keys">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="SSH keys found on this computer:" Margin="10,10,10,5" FontWeight="SemiBold"/>
                    <ListBox Grid.Row="1" Name="LocalKeysList" Margin="10" SelectionMode="Extended" 
                             HorizontalContentAlignment="Stretch"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                <Setter Property="Padding" Value="0"/>
                            </Style>
                        </ListBox.ItemContainerStyle>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border Padding="10" Margin="2" Background="White" CornerRadius="4" BorderBrush="#DDD" BorderThickness="1">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="100"/>
                                            <ColumnDefinition Width="80"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <!-- Key Info -->
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="{Binding KeyName}" FontWeight="Bold" FontSize="14"/>
                                            <TextBlock Text="{Binding KeyType}" Foreground="#666" FontSize="11"/>
                                            <TextBlock Text="{Binding Fingerprint}" FontFamily="Consolas" FontSize="10" Foreground="#888" TextWrapping="Wrap"/>
                                            <TextBlock Text="{Binding StatusText}" Foreground="{Binding StatusColor}" FontSize="11" Margin="0,5,0,0"/>
                                        </StackPanel>
                                        
                                        <!-- Compliance Column -->
                                        <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="5,0">
                                            <TextBlock Text="Compliance" FontSize="9" Foreground="#888"/>
                                            <TextBlock Text="{Binding ComplianceText}" 
                                                       Foreground="{Binding ComplianceColor}" 
                                                       FontSize="11" 
                                                       FontWeight="SemiBold"
                                                       TextWrapping="Wrap"
                                                       ToolTip="{Binding ComplianceText}"/>
                                        </StackPanel>
                                        
                                        <!-- Sync Status Column -->
                                        <StackPanel Grid.Column="2" VerticalAlignment="Center" Margin="5,0">
                                            <TextBlock Text="Synced" FontSize="9" Foreground="#888"/>
                                            <TextBlock Text="{Binding SyncStatus}" 
                                                       Foreground="{Binding SyncStatusColor}" 
                                                       FontSize="11" 
                                                       FontWeight="SemiBold"/>
                                        </StackPanel>
                                        
                                        <!-- Actions Column -->
                                        <StackPanel Grid.Column="3" VerticalAlignment="Center">
                                            <Button Content="{Binding ActionText}" 
                                                    Width="80" Height="28" 
                                                    Click="KeyAction_Click"
                                                    Tag="{Binding}"
                                                    Visibility="{Binding ActionVisibility}"/>
                                        </StackPanel>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                    
                    <!-- Actions for selected keys -->
                    <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="10,0,10,10">
                        <Button Content="Import Key..." Width="100" Height="30" Margin="0,0,10,0" Click="ImportKey_Click" ToolTip="Browse for a key file to add"/>
                        <Button Content="Sync Selected" Width="110" Height="30" Margin="0,0,10,0" Click="SyncSelectedKeys_Click"/>
                        <Button Content="Ignore Key" Width="100" Height="30" Click="RemoveSelectedKeys_Click" ToolTip="Mark selected keys as ignored"/>
                    </StackPanel>
                </Grid>
            </TabItem>
            
            <!-- Server Keys Tab -->
            <TabItem Header="Uploaded Keys">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="Keys published to the central keyring:" Margin="10,10,10,5" FontWeight="SemiBold"/>
                    <ListBox Grid.Row="1" Name="ServerKeysList" Margin="10"
                             HorizontalContentAlignment="Stretch"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                <Setter Property="Padding" Value="0"/>
                            </Style>
                        </ListBox.ItemContainerStyle>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border Padding="10" Margin="2" Background="White" CornerRadius="4" BorderBrush="#DDD" BorderThickness="1">
                                    <StackPanel>
                                        <TextBlock Text="{Binding KeyName}" FontWeight="Bold" FontSize="14"/>
                                        <TextBlock Text="{Binding KeyType}" Foreground="#666" FontSize="11"/>
                                        <TextBlock Text="{Binding Fingerprint}" FontFamily="Consolas" FontSize="10" Foreground="#888" TextWrapping="Wrap"/>
                                        <TextBlock Text="{Binding UploadedAt}" Foreground="#888" FontSize="10" Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </TabItem>
            
            <!-- Ignored Keys Tab -->
            <TabItem Header="Ignored Keys">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Grid.Row="0" Text="Keys you chose not to upload:" Margin="10,10,10,5" FontWeight="SemiBold"/>
                    <ListBox Grid.Row="1" Name="IgnoredKeysList" Margin="10"
                             HorizontalContentAlignment="Stretch"
                             ScrollViewer.HorizontalScrollBarVisibility="Disabled">
                        <ListBox.ItemContainerStyle>
                            <Style TargetType="ListBoxItem">
                                <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                <Setter Property="Padding" Value="0"/>
                            </Style>
                        </ListBox.ItemContainerStyle>
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <Border Padding="10" Margin="2" Background="White" CornerRadius="4" BorderBrush="#DDD" BorderThickness="1">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="{Binding KeyName}" FontWeight="Bold" FontSize="14"/>
                                            <TextBlock Text="{Binding KeyType}" Foreground="#666" FontSize="11"/>
                                            <TextBlock Text="{Binding Fingerprint}" FontFamily="Consolas" FontSize="10" Foreground="#888" TextWrapping="Wrap"/>
                                        </StackPanel>
                                        <Button Grid.Column="1" Content="Un-ignore" 
                                                Width="80" Height="28" 
                                                VerticalAlignment="Center"
                                                Click="UnignoreKey_Click"
                                                Tag="{Binding}"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </Grid>
            </TabItem>
        </TabControl>
        
        <!-- Footer -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,15,0,0">
            <Button Content="Refresh" Width="100" Height="35" Margin="0,0,10,0" Click="RefreshButton_Click"/>
            <Button Content="Close" Width="100" Height="35" Click="CloseButton_Click"/>
        </StackPanel>
    </Grid>
</Window>


